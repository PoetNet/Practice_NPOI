# üìë –ü—Ä–∏–º–µ—Ä —Ä–∞–±–æ—Ç—ã —Å NPOI –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ Excel —Ñ–∞–π–ª–æ–≤ –≤ ASP.NET Core
–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ NPOI –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ Excel —Ñ–∞–π–ª–æ–≤ –≤ ASP.NET Core. –í –∫–æ–¥–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç Excel —Ñ–∞–π–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–∏ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –µ–≥–æ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏.

## üí¨ –¢–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è
[–°–º. —Å—Ç–∞—Ç—å—é](https://habr.com/ru/articles/452094/)

***–î–ª—è –Ω–∞—á–∞–ª–∞ –æ–∑–Ω–∞–∫–æ–º–∏–º—Å—è —Å —Ç–µ—Ä–º–∏–Ω–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω—ã–º–∏ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ (—Ö–æ—Ç—å –∏ –Ω–µ –≤—Å–µ –∏–∑ –Ω–∏—Ö –∑–∞—Ç—Ä–æ–Ω—É—Ç—ã –≤ —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –∫–æ–¥–∞):***

**–ü—Ä–æ—Ü–µ—Å—Å (Process)** ‚Äî –æ–±—ä–µ–∫—Ç –û–°, –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∞–¥—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ—Ç–æ–∫–∏.

**–ü–æ—Ç–æ–∫ (Thread)** ‚Äî –æ–±—ä–µ–∫—Ç –û–°, –Ω–∞–∏–º–µ–Ω—å—à–∞—è –µ–¥–∏–Ω–∏—Ü–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, —á–∞—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞, –ø–æ—Ç–æ–∫–∏ –¥–µ–ª—è—Ç –ø–∞–º—è—Ç—å –∏ –¥—Ä—É–≥–∏–µ —Ä–µ—Å—É—Ä—Å—ã –º–µ–∂–¥—É —Å–æ–±–æ–π –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞.

**–ú–Ω–æ–≥–æ–∑–∞–¥–∞—á–Ω–æ—Å—Ç—å** ‚Äî —Å–≤–æ–π—Å—Ç–≤–æ –û–°, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

**–ú–Ω–æ–≥–æ—è–¥–µ—Ä–Ω–æ—Å—Ç—å** ‚Äî —Å–≤–æ–π—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —è–¥–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö.

**–ú–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω–æ—Å—Ç—å** ‚Äî —Å–≤–æ–π—Å—Ç–≤–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞–º–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏.

**–ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å** ‚Äî —Å–≤–æ–π—Å—Ç–≤–æ –ø—Ä–æ—Ü–µ—Å—Å–∞, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏.

**–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ—Å—Ç—å** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–µ–π—Å—Ç–≤–∏–π —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤ –µ–¥–∏–Ω–∏—Ü—É –≤—Ä–µ–º–µ–Ω–∏.

**–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –±–µ–∑ –æ–∂–∏–¥–∞–Ω–∏—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—Ä–∞–±–æ—Ç–∞–Ω –ø–æ–∑–¥–Ω–µ–µ.

## üöÄ –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

1.  **–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤**
```C#
IRow headerRow = sheet.CreateRow(0);
for (int i = 0; i < properties.Length; i++)
{
    ICell cell = headerRow.CreateCell(i);
    cell.SetCellValue(properties[i].Name);
}
```

2.  **–ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏**
```C#
for (int i = 0; i < data.Count; i++)
{
    TableModel record = data[i];
    IRow row = sheet.CreateRow(i + 1);
    
    for (int j = 0; j < properties.Length; j++)
    {
        ICell cell = row.CreateCell(j);
        object value = properties[j].GetValue(record);
        cell.SetCellValue(value?.ToString() ?? string.Empty);
    }
}
```
3.  **–ó–∞–ø–∏—Å—å –≤ –ø–æ—Ç–æ–∫**
   ```C#
workbook.Write(stream);
var content = stream.ToArray();
```
4. **–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏**
```C#
return File(content, "application/vnd.ms-excel", "–ò—Å—Ç–æ—Ä–∏—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è.xls");
```

## üìö –û–ø–∏—Å–∞–Ω–∏–µ
–í –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ NPOI –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Excel —Ñ–∞–π–ª–∞–º–∏.

1. –°–æ–∑–¥–∞—é—Ç—Å—è –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –¥–∞–Ω–Ω—ã–º–∏. –î–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ IRow –∏ ICell –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ NPOI, –∞ –∑–∞—Ç–µ–º —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ —è—á–µ–π–∫–∏ –º–µ—Ç–æ–¥–æ–º SetCellValue.

2. –î–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ø–æ—Ç–æ–∫ —Ç–∏–ø–∞ MemoryStream, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞—Ç—å Excel —Ñ–∞–π–ª –≤ –ø–∞–º—è—Ç–∏.

3. –§–∞–π–ª –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –∫–ª–∏–µ–Ω—Ç—É —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–µ—Ç–æ–¥–∞ File –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ ASP.NET Core.

–≠—Ç–∏ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –∫–æ–¥–∞ –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ —Å–æ–∑–¥–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã Excel —Ñ–∞–π–ª–∞ –∏ –µ–≥–æ –æ—Ç–ø—Ä–∞–≤–∫—É –∫–ª–∏–µ–Ω—Ç—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏. –ò–∑—É—á–∏–≤ –∏—Ö, –º–æ–∂–Ω–æ –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å, –∫–∞–∫ NPOI –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è –≤ –ø—Ä–æ–µ–∫—Ç –∏ –∫–∞–∫ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è Excel —Ñ–∞–π–ª –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–∏.

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

–ß—Ç–æ–±—ã –∑–∞–ø—É—Å—Ç–∏—Ç—å —ç—Ç–æ—Ç –æ–±—É—á–∞—é—â–∏–π –ø—Ä–æ–µ–∫—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1. –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ —Å–≤–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä.

2. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –≤ –≤–∞—à–µ–π —Å—Ä–µ–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ASP.NET Core (–Ω–∞–ø—Ä–∏–º–µ—Ä, Visual Studio).

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ URL http://localhost:<–Ω–æ–º–µ—Ä_–ø–æ—Ä—Ç–∞>/api/downladexcel –≤ –±—Ä–∞—É–∑–µ—Ä–µ, —á—Ç–æ–±—ã —Å–∫–∞—á–∞—Ç—å Excel —Ñ–∞–π–ª.

## üìö –£—á–µ–±–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª

–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –º–æ–∂–µ—Ç —Å–ª—É–∂–∏—Ç—å —É—á–µ–±–Ω—ã–º –º–∞—Ç–µ—Ä–∏–∞–ª–æ–º –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã —Å –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π NPOI –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ ASP.NET Core. –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å –∫–æ–¥–æ–º, –≤–Ω–æ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ —É–≥–ª—É–±–ª—è–π—Ç–µ—Å—å –≤ –∏–∑—É—á–µ–Ω–∏–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π NPOI. –£–¥–∞—á–∏ ü•∞
